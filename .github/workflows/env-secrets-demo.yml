name: Env and Secrets Demo

on:
  push:
    branches:
      - main

# 1️⃣ Workflow-level environment variables
env:
  APP_NAME: gh-env-demo
  COMMON_MESSAGE: "Hello from workflow level"

jobs:
  demo-env:
    runs-on: ubuntu-latest

    # 2️⃣ Job-level environment variables
    env:
      JOB_MESSAGE: "Hello from job level"
      NODE_ENV: production

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Print workflow & job env vars
        run: |
          echo "App Name: $APP_NAME"
          echo "Common Message: $COMMON_MESSAGE"
          echo "Job Message: $JOB_MESSAGE"
          echo "Node Env: $NODE_ENV"

      - name: Step-level env override
        env:
          JOB_MESSAGE: "Overridden at step level"
          STEP_MESSAGE: "Hello from step level"
        run: |
          echo "Job Message: $JOB_MESSAGE"
          echo "Step Message: $STEP_MESSAGE"

      - name: Using secrets safely
        run: |
          echo "GitHub Token is available."
          echo "API_URL is $API_URL"
        env:
          API_URL: ${{ secrets.API_URL }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
